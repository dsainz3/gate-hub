title: Memorial Stadium Command Center
views:
  - title: Game Day
    path: huskers-gameday
    icon: mdi:football-helmet
    cards:
      # ——— Quick refresh ———
      - type: entities
        title: '🔄 Data Refresh'
        show_header_toggle: false
        entities:
          - type: call-service
            name: Refresh All Data
            icon: mdi:refresh-circle
            action_name: Update All
            service: homeassistant.update_entity
            target:
              entity_id:
                - sensor.huskers_team_name
                - sensor.huskers_opponent_name_2
                - sensor.huskers_team_score
                - sensor.huskers_opponent_score_2
                - sensor.espn_cfb_scoreboard
                - sensor.espn_nebraska_schedule

      # ——— Always visible snapshot ———
      - type: entities
        title: '📊 Live Game Info'
        show_header_toggle: false
        entities:
          - entity: sensor.huskers_team_name
            name: Team
            icon: mdi:football-helmet
          - entity: sensor.huskers_opponent_name_2
            name: Opponent
            icon: mdi:account-group
          - entity: sensor.huskers_team_score
            name: Nebraska Score
            icon: mdi:scoreboard
          - entity: sensor.huskers_opponent_score_2
            name: Opponent Score
            icon: mdi:scoreboard-outline
          - entity: sensor.huskers_quarter
            name: Quarter/Period
            icon: mdi:clock
          - entity: sensor.huskers_game_clock_ct_2
            name: Game Clock
            icon: mdi:timer

      # ——— Pregame ———
      - type: conditional
        conditions:
          - condition: state
            entity: binary_sensor.huskers_pregame_window
            state: 'on'
        card:
          type: vertical-stack
          cards:
            - type: markdown
              content: |
                ## 🏁 Pregame
            - type: entities
              title: '🎯 Next Game'
              show_header_toggle: false
              entities:
                - entity: sensor.huskers_opponent_name_2
                  name: Opponent
                  icon: mdi:football
                - entity: sensor.huskers_kickoff_time_ct_2
                  name: Kickoff (CT)
                  icon: mdi:clock-outline
                - entity: sensor.huskers_venue
                  name: Venue
                  icon: mdi:home-variant
            - type: horizontal-stack
              cards:
                - type: button
                  name: Start 30s Chase
                  icon: mdi:play-speed
                  tap_action:
                    action: call-service
                    service: script.turn_on
                    target:
                      entity_id: script.huskers_chase30_start
                - type: button
                  name: Hail Burst
                  icon: mdi:music-note
                  tap_action:
                    action: call-service
                    service: script.turn_on
                    target:
                      entity_id: script.huskers_hail_burst_8s
                - type: button
                  name: All Scarlet
                  icon: mdi:palette
                  tap_action:
                    action: call-service
                    service: scene.turn_on
                    target:
                      entity_id: scene.huskers_seven_all_scarlet_base

      # ——— Live game ———
      - type: conditional
        conditions:
          - condition: state
            entity: binary_sensor.huskers_game_in_progress_tt
            state: 'on'
        card:
          type: vertical-stack
          cards:
            - type: markdown
              content: |
                ## 🔴 Live Game
            - type: entities
              title: '🏆 Scoreboard'
              show_header_toggle: false
              entities:
                - entity: sensor.huskers_game_clock_ct_2
                  name: Status
                  icon: mdi:football
                - entity: sensor.huskers_team_name
                  name: Nebraska
                  icon: mdi:home
                - entity: sensor.huskers_team_score
                  name: Nebraska Score
                  icon: mdi:scoreboard
                - entity: sensor.huskers_opponent_name_2
                  name: Opponent
                  icon: mdi:airplane-takeoff
                - entity: sensor.huskers_opponent_score_2
                  name: Opponent Score
                  icon: mdi:scoreboard-outline
                - entity: sensor.huskers_quarter
                  name: Quarter
                  icon: mdi:clock
            - type: horizontal-stack
              cards:
                - type: button
                  name: 🎉 Touchdown
                  icon: mdi:football
                  tap_action:
                    action: call-service
                    service: script.turn_on
                    target:
                      entity_id: script.huskers_hail_burst_8s
                - type: button
                  name: Chase Lights
                  icon: mdi:play-circle
                  tap_action:
                    action: call-service
                    service: script.turn_on
                    target:
                      entity_id: script.huskers_chase_speed_start
                - type: button
                  name: Stop All Shows
                  icon: mdi:stop-circle
                  tap_action:
                    action: call-service
                    service: script.turn_on
                    target:
                      entity_id: script.kiosk_stop_all_huskers_shows
            - type: history-graph
              title: '🎨 Light Show Activity'
              hours_to_show: 2
              entities:
                - entity: light.theater_lights
                - entity: light.front_porch_lights
                - entity: light.all_exterior_lights

      # ——— Postgame ———
      - type: conditional
        conditions:
          - condition: state
            entity: binary_sensor.huskers_postgame_window
            state: 'on'
        card:
          type: vertical-stack
          cards:
            - type: markdown
              content: |
                ## ✅ Final
            - type: entities
              title: '🏁 Result'
              show_header_toggle: false
              entities:
                - entity: sensor.huskers_team_name
                  name: Nebraska
                - entity: sensor.huskers_team_score
                  name: Nebraska Score
                - entity: sensor.huskers_opponent_name_2
                  name: Opponent
                - entity: sensor.huskers_opponent_score_2
                  name: Opponent Score
                - entity: sensor.huskers_game_clock_ct_2
                  name: Final Status
            - type: button
              name: 🎊 Victory Celebration
              icon: mdi:trophy
              tap_action:
                action: call-service
                service: script.turn_on
                target:
                  entity_id: script.huskers_hail_burst_8s

      # ——— ESPN Live Game Data (if available) ———
      - type: conditional
        conditions:
          - condition: template
            value_template: "{{ states('sensor.huskers_game_status_espn') != 'No game today' }}"
        card:
          type: entities
          title: '🏈 ESPN Live Game Data'
          entities:
            - entity: sensor.huskers_game_status_espn
              name: Game Status
            - entity: sensor.huskers_game_status_espn
              type: attribute
              attribute: home_team
              name: Home Team
            - entity: sensor.huskers_game_status_espn
              type: attribute
              attribute: away_team
              name: Away Team

      # ——— Manual score/testing ———
      - type: entities
        title: '🎮 Manual Score Control (Testing)'
        show_header_toggle: false
        entities:
          - entity: input_number.huskers_our_score
            name: Our Score (Auto)
          - entity: input_number.huskers_our_score_manual
            name: Our Score (Manual)
          - entity: input_number.huskers_kickoff_in_manual
            name: Kickoff In (Manual)

      # ——— Light show controls ———
      - type: entities
        title: '💡 Light Shows'
        show_header_toggle: false
        entities:
          - entity: input_boolean.huskers_automations_enabled
            name: Automations Enabled
          - entity: input_boolean.huskers_color_show
            name: Color Show Active
          - entity: input_boolean.huskers_theater_show_running
            name: Theater Show Running
          - entity: input_number.huskers_hail_varsity_bpm
            name: Hail Varsity BPM
          - entity: input_number.huskers_chase_cycle_seconds
            name: Chase Cycle (seconds)
          - entity: input_number.huskers_hail_bpm
            name: Hail BPM

      - type: entities
        title: '🎭 Manual Light Controls'
        show_header_toggle: false
        entities:
          - type: call-service
            name: Start 30s Chase
            icon: mdi:play-speed
            action_name: Start
            service: script.turn_on
            target:
              entity_id: script.huskers_chase30_start
          - type: call-service
            name: Start Variable Chase
            icon: mdi:play-circle
            action_name: Start
            service: script.turn_on
            target:
              entity_id: script.huskers_chase_speed_start
          - type: call-service
            name: Hail Varsity Burst
            icon: mdi:music-note
            action_name: Play
            service: script.turn_on
            target:
              entity_id: script.huskers_hail_burst_8s
          - type: call-service
            name: All Scarlet Scene
            icon: mdi:palette
            action_name: Activate
            service: scene.turn_on
            target:
              entity_id: scene.huskers_seven_all_scarlet_base
          - type: call-service
            name: Stop All Shows
            icon: mdi:stop-circle
            action_name: Stop
            service: script.turn_on
            target:
              entity_id: script.kiosk_stop_all_huskers_shows

      - type: grid
        square: false
        columns: 3
        cards:
          - type: light
            entity: light.theater_lights
            name: Theater Lights
          - type: light
            entity: light.front_porch_lights
            name: Front Porch
          - type: light
            entity: light.all_exterior_lights
            name: All Exterior
          - type: light
            entity: light.office_lights
            name: Office Lights
          - type: light
            entity: light.mainfloor_lights
            name: Main Floor
          - type: light
            entity: light.all_lights
            name: All Lights

      # ——— Phase + timers ———
      - type: entities
        title: '🔧 Game Phase & Status'
        show_header_toggle: false
        entities:
          - entity: binary_sensor.huskers_pregame_window
            name: Pregame Window
          - entity: binary_sensor.huskers_game_in_progress_tt
            name: Game In Progress
          - entity: binary_sensor.huskers_postgame_window
            name: Postgame Window
          - entity: sensor.huskers_kickoff_in_2
            name: Kickoff In (minutes)

      # ——— Schedule (ESPN combined / free fallback) ———
      - type: conditional
        conditions:
          - condition: template
            value_template: "{{ has_value('sensor.huskers_schedule_combined') }}"
        card:
          type: markdown
          title: '📅 Schedule'
          content: |
            {{ states('sensor.huskers_schedule_combined') }}
      - type: conditional
        conditions:
          - condition: template
            value_template: "{{ not has_value('sensor.huskers_schedule_combined') and has_value('sensor.huskers_schedule_free') }}"
        card:
          type: markdown
          title: '📅 Schedule'
          content: |
            {{ states('sensor.huskers_schedule_free') }}

      # ——— Rankings/Record ———
      - type: entities
        title: '🏅 Rankings & Record'
        show_header_toggle: false
        entities:
          - entity: sensor.huskers_ap_ranking_espn
            name: AP Rank (ESPN)
          - entity: sensor.huskers_rankings_free
            name: AP Rank (Free)
          - entity: sensor.huskers_record_free
            name: Record

      # ——— System status (rolled in) ———
      - type: entities
        title: '📡 Game Data Status'
        show_header_toggle: false
        entities:
          - entity: sensor.huskers_team_name
            name: Team Name
            icon: mdi:football-helmet
          - entity: sensor.huskers_opponent_name_2
            name: Opponent Data
            icon: mdi:account-group
          - entity: sensor.huskers_team_score
            name: Team Score Data
            icon: mdi:scoreboard
          - entity: sensor.huskers_opponent_score_2
            name: Opponent Score Data
            icon: mdi:scoreboard-outline
          - entity: sensor.huskers_quarter
            name: Quarter Data
            icon: mdi:clock
          - entity: sensor.huskers_game_clock_ct_2
            name: Game Clock Data
            icon: mdi:timer

      - type: entities
        title: '🤖 Active Automations'
        show_header_toggle: false
        entities:
          - entity: automation.huskers_showtime_at_t_20
            name: Showtime at T-20
          - entity: automation.huskers_td_burst_on_score
            name: TD Burst on Score
          - entity: automation.huskers_postgame_cleanup
            name: Postgame Cleanup

      - type: markdown
        title: '📝 System Notes'
        content: |
          **Working:** live scores, phase detection, light show scripts, manual score inputs, theater/exterior controls.
          **Issues:** ESPN sensors unavailable, advanced scripts unavailable, schedule/rankings flaky.
          **Try:** check ESPN endpoints, internet connectivity, template sensors, and use manual score inputs for testing.
