title: Network Dashboard
views:
  - title: Overview
    path: network
    icon: mdi:access-point-network
    cards:
      - type: markdown
        content: >-
          {% macro fmt(value, precision=1, unit='') -%}
            {%- if value in ['unknown', 'unavailable', None] -%}
              –
            {%- else -%}
              {%- set num = (value | float(0)) | round(precision) -%}
              {%- if precision == 0 -%}
                {{ num | int }}{{ ' ' ~ unit if unit else '' }}
              {%- else -%}
                {{ num }}{{ ' ' ~ unit if unit else '' }}
              {%- endif -%}
            {%- endif -%}
          {%- endmacro %}
          {% macro trend(current, reference, unit='') -%}
            {%- if current in ['unknown', 'unavailable', None] or reference in ['unknown', 'unavailable', None] -%}
              –
            {%- else -%}
              {%- set ref = reference | float(0) -%}
              {%- if ref == 0 -%}
                –
              {%- else -%}
                {%- set diff = (current | float(0)) - ref -%}
                {%- if diff > 0 -%}
                  ↑ {{ diff | round(1) }}{{ unit }}
                {%- elif diff < 0 -%}
                  ↓ {{ (diff | abs) | round(1) }}{{ unit }}
                {%- else -%}
                  → 0{{ unit }}
                {%- endif -%}
              {%- endif -%}
            {%- endif -%}
          {%- endmacro %}
          {% macro trend_compare(current, reference, trend_unit='', fmt_unit='', precision=1, label=None) -%}
            {%- set t = trend(current, reference, trend_unit) -%}
            {%- if t == '–' -%}
              –
            {%- elif reference in ['unknown', 'unavailable', None] -%}
              {{ t }}
            {%- else -%}
              {%- set lbl = label if label not in [None, 'unavailable'] else 'baseline' -%}
              {{ t }} vs {{ lbl }} {{ fmt(reference, precision, fmt_unit) }}
            {%- endif -%}
          {%- endmacro %}
          {% set last_speedtest = state_attr('sensor.network_status_summary', 'last_speedtest') %}
          {% set last_label = 'pending runs' %}
          {% if last_speedtest not in ['unknown', 'unavailable', None] %}
            {% set dt = as_datetime(last_speedtest) %}
            {% if dt %}
              {% set last_label = as_timestamp(dt) | timestamp_custom('%b %-d, %Y %-I:%M %p %Z', True) %}
            {% endif %}
          {% endif %}
          {% set reachability = is_state('binary_sensor.internet_reachability', 'on') %}
          {% set clients_total = state_attr('sensor.deco_network_health', 'clients_total') %}
          {% set latency_live = states('sensor.internet_latency') %}
          {% set latency_source = 'Internet latency' %}
          {% if latency_live in ['unknown', 'unavailable', None] %}
            {% set latency_live = states('sensor.speedtest_ping') %}
            {% set latency_source = 'Speedtest ping' %}
          {% endif %}
          {% set latency_ref = states('sensor.internet_latency_baseline') %}
          {% set latency_ref_label = state_attr('sensor.internet_latency_baseline', 'source_label') %}
          {% if latency_ref in ['unknown', 'unavailable', None] %}
            {% set latency_ref = states('sensor.speedtest_ping_baseline') %}
            {% set latency_ref_label = state_attr('sensor.speedtest_ping_baseline', 'source_label') %}
          {% endif %}
          {% set download_ref = states('sensor.speedtest_download_baseline') %}
          {% set download_ref_label = state_attr('sensor.speedtest_download_baseline', 'source_label') %}
          {% set upload_ref = states('sensor.speedtest_upload_baseline') %}
          {% set upload_ref_label = state_attr('sensor.speedtest_upload_baseline', 'source_label') %}
          {% set ping_ref = states('sensor.speedtest_ping_baseline') %}
          {% set ping_ref_label = state_attr('sensor.speedtest_ping_baseline', 'source_label') %}
          {% set deco_down_ref = states('sensor.deco_total_down_baseline') %}
          {% set deco_down_ref_label = state_attr('sensor.deco_total_down_baseline', 'source_label') %}
          {% set deco_up_ref = states('sensor.deco_total_up_baseline') %}
          {% set deco_up_ref_label = state_attr('sensor.deco_total_up_baseline', 'source_label') %}
          {% set latency_trend = trend_compare(latency_live, latency_ref, ' ms', 'ms', 1, latency_ref_label) %}
          {% set download_trend = trend_compare(states('sensor.speedtest_download'), download_ref, ' Mbps', 'Mbps', 1, download_ref_label) %}
          {% set upload_trend = trend_compare(states('sensor.speedtest_upload'), upload_ref, ' Mbps', 'Mbps', 1, upload_ref_label) %}
          {% set ping_trend = trend_compare(states('sensor.speedtest_ping'), ping_ref, ' ms', 'ms', 1, ping_ref_label) %}
          {% set deco_down_trend = trend_compare(states('sensor.deco_total_down_mbps'), deco_down_ref, ' Mbps', 'Mbps', 2, deco_down_ref_label) %}
          {% set deco_up_trend = trend_compare(states('sensor.deco_total_up_mbps'), deco_up_ref, ' Mbps', 'Mbps', 2, deco_up_ref_label) %}
          ## Network Snapshot
          **Status:** {{ states('sensor.network_status_summary') | title }} · {{ states('sensor.network_performance_summary') | title }}

          **Ping:** {{ fmt(latency_live) }} ms ({{ latency_source | lower }}, {{ 'reachable' if reachability else 'unreachable' }}) ·
          {{ latency_trend }}

          **Speedtest:** ↓ {{ fmt(states('sensor.speedtest_download'), 1, 'Mbps') }}
          ({{ download_trend }}) · ↑ {{ fmt(states('sensor.speedtest_upload'), 1, 'Mbps') }}
          ({{ upload_trend }}) ·
          Ping {{ fmt(states('sensor.speedtest_ping'), 1, 'ms') }}
          ({{ ping_trend }})

          **Deco Throughput:** ↓ {{ fmt(states('sensor.deco_total_down_mbps'), 2, 'Mbps') }}
          ({{ deco_down_trend }}) ·
          ↑ {{ fmt(states('sensor.deco_total_up_mbps'), 2, 'Mbps') }}
          ({{ deco_up_trend }}) ·
          Clients {{ fmt(states('sensor.deco_client_count'), 0) }}
          {% if clients_total is not none %}/ {{ clients_total }}{% endif %}
          ({{ states('sensor.deco_network_health') | title }})

          **Latency averages:** 1h {{ fmt(states('sensor.internet_latency_1h_avg')) }} ·
          24h {{ fmt(states('sensor.internet_latency_24h_avg')) }} ·
          7d {{ fmt(states('sensor.internet_latency_7d_avg')) }} ·
          30d {{ fmt(states('sensor.internet_latency_30d_avg')) }}

          **Last Speed Test:** {{ last_label }}
      - type: grid
        columns: 3
        square: false
        cards:
          - type: tile
            entity: binary_sensor.network_dashboard_internet_online
            name: Internet online
            color: '#43a047'
          - type: tile
            entity: sensor.network_performance_summary
            name: Performance state
            color: '#fb8c00'
          - type: tile
            entity: sensor.deco_network_health
            name: Deco health
            color: '#1e88e5'
          - type: tile
            entity: sensor.network_dashboard_live_latency
            name: Live latency
            color: '#039be5'
          - type: tile
            entity: sensor.speedtest_download
            name: Download Mbps
            color: '#3949ab'
          - type: tile
            entity: sensor.speedtest_upload
            name: Upload Mbps
            color: '#8d6e63'
          - type: tile
            entity: sensor.speedtest_ping
            name: Speedtest ping
            color: '#ef6c00'
          - type: tile
            entity: sensor.deco_total_down_mbps
            name: Deco down Mbps
            color: '#26a69a'
          - type: tile
            entity: sensor.deco_total_up_mbps
            name: Deco up Mbps
            color: '#7e57c2'
          - type: tile
            entity: sensor.deco_client_count
            name: Clients online
            color: '#5e35b1'
          - type: tile
            entity: sensor.deco_node_count
            name: Nodes online
            color: '#1565c0'
          - type: tile
            entity: sensor.speedtest_last_run
            name: Last speedtest
            color: '#546e7a'
      - type: custom:apexcharts-card
        header:
          title: Latency vs averages (24h)
          show: true
        graph_span: 24h
        span:
          end: hour
        yaxis:
          - min: 0
        apex_config:
          stroke:
            width: 2
          legend:
            show: true
        series:
          - entity: sensor.internet_latency
            name: Current
            color: '#1e88e5'
            float_precision: 1
          - entity: sensor.internet_latency_1h_avg
            name: 1h avg
            color: '#43a047'
            type: line
            float_precision: 1
          - entity: sensor.internet_latency_24h_avg
            name: 24h avg
            color: '#fdd835'
            type: line
            float_precision: 1
      - type: custom:apexcharts-card
        header:
          title: Deco throughput (6h)
          show: true
        graph_span: 6h
        span:
          end: hour
        yaxis:
          - min: 0
        apex_config:
          stroke:
            width: 2
          legend:
            show: true
        series:
          - entity: sensor.deco_total_down_mbps
            name: Down
            color: '#26a69a'
            float_precision: 2
          - entity: sensor.deco_total_up_mbps
            name: Up
            color: '#7e57c2'
            float_precision: 2
      - type: custom:apexcharts-card
        header:
          title: Speedtest results (30d)
          show: true
        graph_span: 30d
        span:
          end: day
        yaxis:
          - min: 0
        apex_config:
          stroke:
            width: 2
          legend:
            show: true
        series:
          - entity: sensor.speedtest_download
            name: Download
            type: line
            color: '#3949ab'
            float_precision: 1
          - entity: sensor.speedtest_upload
            name: Upload
            type: line
            color: '#8d6e63'
            float_precision: 1
          - entity: sensor.speedtest_ping
            name: Ping
            type: line
            color: '#ef6c00'
            float_precision: 1
          - entity: sensor.speedtest_download_7d_avg
            name: Download 7d avg
            type: line
            color: '#5c6bc0'
            float_precision: 1
          - entity: sensor.speedtest_upload_7d_avg
            name: Upload 7d avg
            type: line
            color: '#a1887f'
            float_precision: 1
      - type: custom:apexcharts-card
        header:
          title: Speedtest ping vs averages (7d)
          show: true
        graph_span: 7d
        span:
          end: hour
        yaxis:
          - min: 0
        apex_config:
          stroke:
            width: 2
          legend:
            show: true
        series:
          - entity: sensor.speedtest_ping
            name: Ping
            color: '#ef6c00'
            float_precision: 1
          - entity: sensor.speedtest_ping_24h_avg
            name: 24h avg
            color: '#ffb300'
            type: line
            float_precision: 1
          - entity: sensor.speedtest_ping_7d_avg
            name: 7d avg
            color: '#ffa726'
            type: line
            float_precision: 1
      - type: entities
        title: Live network sensors
        show_header_toggle: false
        entities:
          - binary_sensor.internet_reachability
          - sensor.internet_latency
          - sensor.speedtest_ping
          - sensor.speedtest_download
          - sensor.speedtest_upload
          - sensor.deco_total_down_mbps
          - sensor.deco_total_up_mbps
          - sensor.deco_client_count
          - sensor.deco_node_count
          - sensor.network_performance_summary
          - sensor.speedtest_last_run
          - update.tp_link_deco_update
          - update.tp_link_router_update
      - type: markdown
        title: Rolling averages
        content: >-
          {% macro fmt(val, unit='') -%}
            {%- if val in [None, 'unknown', 'unavailable'] -%}
              –
            {%- else -%}
              {%- set num = (val | float(0)) | round(2) -%}
              {%- if num == num | int -%}
                {{ num | int }}{{ ' ' ~ unit if unit else '' }}
              {%- else -%}
                {{ num }}{{ ' ' ~ unit if unit else '' }}
              {%- endif -%}
            {%- endif -%}
          {%- endmacro %}
          {% macro row(title, key, unit='') -%}
            {%- set item = metrics.get(key, {}) -%}
            {%- set baseline_label = item.get('baseline_label') -%}
            {%- set baseline_display = fmt(item.get('baseline'), unit) -%}
            {%- if baseline_label not in [None, 'unavailable'] -%}
              {%- set baseline_display = baseline_display ~ ' (' ~ baseline_label ~ ')' -%}
            {%- endif -%}
            {%- set cells = [
              '**' ~ title ~ '**',
              fmt(item.get('current'), unit),
              fmt(item.get('avg_1h'), unit),
              fmt(item.get('avg_24h'), unit),
              fmt(item.get('avg_7d'), unit),
              fmt(item.get('avg_30d'), unit),
              baseline_display
            ] -%}
            {%- set joined = cells | join(' | ') -%}
            | {{ joined }} |
          {%- endmacro %}
          {% set metrics_attr = state_attr('sensor.network_performance_summary', 'metrics') %}
          {% set metrics = metrics_attr | from_json if metrics_attr else {} %}
          {% if metrics %}
          | Metric | Current | 1h | 24h | 7d | 30d | Baseline |
          | :- | :-: | :-: | :-: | :-: | :-: | :- |
          {{ row('Latency', 'latency', 'ms') }}
          {{ row('Download', 'download', 'Mbps') }}
          {{ row('Upload', 'upload', 'Mbps') }}
          {{ row('Ping', 'ping', 'ms') }}
          {{ row('Deco ↓', 'deco_down', 'Mbps') }}
          {{ row('Deco ↑', 'deco_up', 'Mbps') }}
          {% else %}
          _Rolling statistics unavailable_
          {% endif %}
      - type: custom:auto-entities
        show_empty: false
        card:
          type: entities
          title: Deco nodes
          show_header_toggle: false
        filter:
          include:
            - domain: device_tracker
              integration: tplink_deco
              attributes:
                device_type: deco
      - type: custom:auto-entities
        show_empty: false
        card:
          type: entities
          title: Ping sensors
          show_header_toggle: false
        filter:
          include:
            - entity_id: sensor.ping_*
      - type: button
        name: Run Speedtest Now
        icon: mdi:speedometer
        tap_action:
          action: call-service
          service: homeassistant.update_entity
          target:
            entity_id:
              - sensor.speedtest_download
              - sensor.speedtest_upload
              - sensor.speedtest_ping
        hold_action:
          action: none
  - title: History
    path: network-history
    icon: mdi:chart-line
    cards:
      - type: custom:mushroom-chips-card
        alignment: center
        chips:
          - type: template
            icon: mdi:clock-time-three-outline
            icon_color: >-
              [[[ return states['input_select.network_history_range'].state === '1d' ? 'primary' : 'disabled'; ]]]
            content: 1d
            tap_action:
              action: call-service
              service: input_select.select_option
              data:
                option: 1d
              target:
                entity_id: input_select.network_history_range
          - type: template
            icon: mdi:clock-time-three-outline
            icon_color: >-
              [[[ return states['input_select.network_history_range'].state === '3d' ? 'primary' : 'disabled'; ]]]
            content: 3d
            tap_action:
              action: call-service
              service: input_select.select_option
              data:
                option: 3d
              target:
                entity_id: input_select.network_history_range
          - type: template
            icon: mdi:clock-time-three-outline
            icon_color: >-
              [[[ return states['input_select.network_history_range'].state === '5d' ? 'primary' : 'disabled'; ]]]
            content: 5d
            tap_action:
              action: call-service
              service: input_select.select_option
              data:
                option: 5d
              target:
                entity_id: input_select.network_history_range
          - type: template
            icon: mdi:calendar-week
            icon_color: >-
              [[[ return states['input_select.network_history_range'].state === '1w' ? 'primary' : 'disabled'; ]]]
            content: 1w
            tap_action:
              action: call-service
              service: input_select.select_option
              data:
                option: 1w
              target:
                entity_id: input_select.network_history_range
          - type: template
            icon: mdi:calendar-week
            icon_color: >-
              [[[ return states['input_select.network_history_range'].state === '2w' ? 'primary' : 'disabled'; ]]]
            content: 2w
            tap_action:
              action: call-service
              service: input_select.select_option
              data:
                option: 2w
              target:
                entity_id: input_select.network_history_range
          - type: template
            icon: mdi:calendar-month
            icon_color: >-
              [[[ return states['input_select.network_history_range'].state === '1m' ? 'primary' : 'disabled'; ]]]
            content: 1m
            tap_action:
              action: call-service
              service: input_select.select_option
              data:
                option: 1m
              target:
                entity_id: input_select.network_history_range
          - type: template
            icon: mdi:calendar-multiple
            icon_color: >-
              [[[ return states['input_select.network_history_range'].state === '3m' ? 'primary' : 'disabled'; ]]]
            content: 3m
            tap_action:
              action: call-service
              service: input_select.select_option
              data:
                option: 3m
              target:
                entity_id: input_select.network_history_range
      - type: custom:state-switch
        entity: input_select.network_history_range
        default: 1w
        states:
          1d:
            type: vertical-stack
            cards:
              - type: custom:apexcharts-card
                header:
                  title: Latency trend (1d)
                  show: true
                graph_span: 1d
                span:
                  end: hour
                yaxis:
                  - min: 0
                apex_config:
                  stroke:
                    width: 2
                  legend:
                    show: true
                series:
                  - entity: sensor.internet_latency
                    name: Current
                    color: '#1e88e5'
                    float_precision: 1
                  - entity: sensor.internet_latency_24h_avg
                    name: 24h avg
                    color: '#fdd835'
                    type: line
                    float_precision: 1
                  - entity: sensor.internet_latency_7d_avg
                    name: 7d avg
                    color: '#43a047'
                    type: line
                    float_precision: 1
              - type: custom:apexcharts-card
                header:
                  title: Speedtest download vs upload (1d)
                  show: true
                graph_span: 1d
                span:
                  end: hour
                yaxis:
                  - min: 0
                apex_config:
                  stroke:
                    width: 2
                  legend:
                    show: true
                series:
                  - entity: sensor.speedtest_download
                    name: Download
                    type: line
                    color: '#3949ab'
                    float_precision: 1
                  - entity: sensor.speedtest_upload
                    name: Upload
                    type: line
                    color: '#8d6e63'
                    float_precision: 1
                  - entity: sensor.speedtest_download_30d_avg
                    name: Download 30d avg
                    type: line
                    color: '#5c6bc0'
                    float_precision: 1
                  - entity: sensor.speedtest_upload_30d_avg
                    name: Upload 30d avg
                    type: line
                    color: '#a1887f'
                    float_precision: 1
              - type: custom:apexcharts-card
                header:
                  title: Deco throughput (1d)
                  show: true
                graph_span: 1d
                span:
                  end: hour
                yaxis:
                  - min: 0
                apex_config:
                  stroke:
                    width: 2
                  legend:
                    show: true
                series:
                  - entity: sensor.deco_total_down_mbps
                    name: Down
                    type: line
                    color: '#26a69a'
                    float_precision: 2
                  - entity: sensor.deco_total_up_mbps
                    name: Up
                    type: line
                    color: '#7e57c2'
                    float_precision: 2
                  - entity: sensor.deco_total_down_mbps_7d_avg
                    name: Down 7d avg
                    type: line
                    color: '#4db6ac'
                    float_precision: 2
                  - entity: sensor.deco_total_up_mbps_7d_avg
                    name: Up 7d avg
                    type: line
                    color: '#9575cd'
                    float_precision: 2
              - type: custom:apexcharts-card
                header:
                  title: Speedtest ping (1d)
                  show: true
                graph_span: 1d
                span:
                  end: hour
                yaxis:
                  - min: 0
                apex_config:
                  stroke:
                    width: 2
                  legend:
                    show: true
                series:
                  - entity: sensor.speedtest_ping
                    name: Ping
                    type: line
                    color: '#ef6c00'
                    float_precision: 1
                  - entity: sensor.speedtest_ping_30d_avg
                    name: Ping 30d avg
                    type: line
                    color: '#ffb300'
                    float_precision: 1
          3d:
            type: vertical-stack
            cards:
              - type: custom:apexcharts-card
                header:
                  title: Latency trend (3d)
                  show: true
                graph_span: 3d
                span:
                  end: hour
                yaxis:
                  - min: 0
                apex_config:
                  stroke:
                    width: 2
                  legend:
                    show: true
                series:
                  - entity: sensor.internet_latency
                    name: Current
                    color: '#1e88e5'
                    float_precision: 1
                  - entity: sensor.internet_latency_24h_avg
                    name: 24h avg
                    color: '#fdd835'
                    type: line
                    float_precision: 1
                  - entity: sensor.internet_latency_7d_avg
                    name: 7d avg
                    color: '#43a047'
                    type: line
                    float_precision: 1
              - type: custom:apexcharts-card
                header:
                  title: Speedtest download vs upload (3d)
                  show: true
                graph_span: 3d
                span:
                  end: hour
                yaxis:
                  - min: 0
                apex_config:
                  stroke:
                    width: 2
                  legend:
                    show: true
                series:
                  - entity: sensor.speedtest_download
                    name: Download
                    type: line
                    color: '#3949ab'
                    float_precision: 1
                  - entity: sensor.speedtest_upload
                    name: Upload
                    type: line
                    color: '#8d6e63'
                    float_precision: 1
                  - entity: sensor.speedtest_download_30d_avg
                    name: Download 30d avg
                    type: line
                    color: '#5c6bc0'
                    float_precision: 1
                  - entity: sensor.speedtest_upload_30d_avg
                    name: Upload 30d avg
                    type: line
                    color: '#a1887f'
                    float_precision: 1
              - type: custom:apexcharts-card
                header:
                  title: Deco throughput (3d)
                  show: true
                graph_span: 3d
                span:
                  end: hour
                yaxis:
                  - min: 0
                apex_config:
                  stroke:
                    width: 2
                  legend:
                    show: true
                series:
                  - entity: sensor.deco_total_down_mbps
                    name: Down
                    type: line
                    color: '#26a69a'
                    float_precision: 2
                  - entity: sensor.deco_total_up_mbps
                    name: Up
                    type: line
                    color: '#7e57c2'
                    float_precision: 2
                  - entity: sensor.deco_total_down_mbps_7d_avg
                    name: Down 7d avg
                    type: line
                    color: '#4db6ac'
                    float_precision: 2
                  - entity: sensor.deco_total_up_mbps_7d_avg
                    name: Up 7d avg
                    type: line
                    color: '#9575cd'
                    float_precision: 2
              - type: custom:apexcharts-card
                header:
                  title: Speedtest ping (3d)
                  show: true
                graph_span: 3d
                span:
                  end: hour
                yaxis:
                  - min: 0
                apex_config:
                  stroke:
                    width: 2
                  legend:
                    show: true
                series:
                  - entity: sensor.speedtest_ping
                    name: Ping
                    type: line
                    color: '#ef6c00'
                    float_precision: 1
                  - entity: sensor.speedtest_ping_30d_avg
                    name: Ping 30d avg
                    type: line
                    color: '#ffb300'
                    float_precision: 1
          5d:
            type: vertical-stack
            cards:
              - type: custom:apexcharts-card
                header:
                  title: Latency trend (5d)
                  show: true
                graph_span: 5d
                span:
                  end: hour
                yaxis:
                  - min: 0
                apex_config:
                  stroke:
                    width: 2
                  legend:
                    show: true
                series:
                  - entity: sensor.internet_latency
                    name: Current
                    color: '#1e88e5'
                    float_precision: 1
                  - entity: sensor.internet_latency_24h_avg
                    name: 24h avg
                    color: '#fdd835'
                    type: line
                    float_precision: 1
                  - entity: sensor.internet_latency_7d_avg
                    name: 7d avg
                    color: '#43a047'
                    type: line
                    float_precision: 1
              - type: custom:apexcharts-card
                header:
                  title: Speedtest download vs upload (5d)
                  show: true
                graph_span: 5d
                span:
                  end: hour
                yaxis:
                  - min: 0
                apex_config:
                  stroke:
                    width: 2
                  legend:
                    show: true
                series:
                  - entity: sensor.speedtest_download
                    name: Download
                    type: line
                    color: '#3949ab'
                    float_precision: 1
                  - entity: sensor.speedtest_upload
                    name: Upload
                    type: line
                    color: '#8d6e63'
                    float_precision: 1
                  - entity: sensor.speedtest_download_30d_avg
                    name: Download 30d avg
                    type: line
                    color: '#5c6bc0'
                    float_precision: 1
                  - entity: sensor.speedtest_upload_30d_avg
                    name: Upload 30d avg
                    type: line
                    color: '#a1887f'
                    float_precision: 1
              - type: custom:apexcharts-card
                header:
                  title: Deco throughput (5d)
                  show: true
                graph_span: 5d
                span:
                  end: hour
                yaxis:
                  - min: 0
                apex_config:
                  stroke:
                    width: 2
                  legend:
                    show: true
                series:
                  - entity: sensor.deco_total_down_mbps
                    name: Down
                    type: line
                    color: '#26a69a'
                    float_precision: 2
                  - entity: sensor.deco_total_up_mbps
                    name: Up
                    type: line
                    color: '#7e57c2'
                    float_precision: 2
                  - entity: sensor.deco_total_down_mbps_7d_avg
                    name: Down 7d avg
                    type: line
                    color: '#4db6ac'
                    float_precision: 2
                  - entity: sensor.deco_total_up_mbps_7d_avg
                    name: Up 7d avg
                    type: line
                    color: '#9575cd'
                    float_precision: 2
              - type: custom:apexcharts-card
                header:
                  title: Speedtest ping (5d)
                  show: true
                graph_span: 5d
                span:
                  end: hour
                yaxis:
                  - min: 0
                apex_config:
                  stroke:
                    width: 2
                  legend:
                    show: true
                series:
                  - entity: sensor.speedtest_ping
                    name: Ping
                    type: line
                    color: '#ef6c00'
                    float_precision: 1
                  - entity: sensor.speedtest_ping_30d_avg
                    name: Ping 30d avg
                    type: line
                    color: '#ffb300'
                    float_precision: 1
          1w:
            type: vertical-stack
            cards:
              - type: custom:apexcharts-card
                header:
                  title: Latency trend (1w)
                  show: true
                graph_span: 7d
                span:
                  end: day
                yaxis:
                  - min: 0
                apex_config:
                  stroke:
                    width: 2
                  legend:
                    show: true
                series:
                  - entity: sensor.internet_latency
                    name: Current
                    color: '#1e88e5'
                    float_precision: 1
                  - entity: sensor.internet_latency_24h_avg
                    name: 24h avg
                    color: '#fdd835'
                    type: line
                    float_precision: 1
                  - entity: sensor.internet_latency_7d_avg
                    name: 7d avg
                    color: '#43a047'
                    type: line
                    float_precision: 1
              - type: custom:apexcharts-card
                header:
                  title: Speedtest download vs upload (1w)
                  show: true
                graph_span: 7d
                span:
                  end: day
                yaxis:
                  - min: 0
                apex_config:
                  stroke:
                    width: 2
                  legend:
                    show: true
                series:
                  - entity: sensor.speedtest_download
                    name: Download
                    type: line
                    color: '#3949ab'
                    float_precision: 1
                  - entity: sensor.speedtest_upload
                    name: Upload
                    type: line
                    color: '#8d6e63'
                    float_precision: 1
                  - entity: sensor.speedtest_download_30d_avg
                    name: Download 30d avg
                    type: line
                    color: '#5c6bc0'
                    float_precision: 1
                  - entity: sensor.speedtest_upload_30d_avg
                    name: Upload 30d avg
                    type: line
                    color: '#a1887f'
                    float_precision: 1
              - type: custom:apexcharts-card
                header:
                  title: Deco throughput (1w)
                  show: true
                graph_span: 7d
                span:
                  end: day
                yaxis:
                  - min: 0
                apex_config:
                  stroke:
                    width: 2
                  legend:
                    show: true
                series:
                  - entity: sensor.deco_total_down_mbps
                    name: Down
                    type: line
                    color: '#26a69a'
                    float_precision: 2
                  - entity: sensor.deco_total_up_mbps
                    name: Up
                    type: line
                    color: '#7e57c2'
                    float_precision: 2
                  - entity: sensor.deco_total_down_mbps_7d_avg
                    name: Down 7d avg
                    type: line
                    color: '#4db6ac'
                    float_precision: 2
                  - entity: sensor.deco_total_up_mbps_7d_avg
                    name: Up 7d avg
                    type: line
                    color: '#9575cd'
                    float_precision: 2
              - type: custom:apexcharts-card
                header:
                  title: Speedtest ping (1w)
                  show: true
                graph_span: 7d
                span:
                  end: day
                yaxis:
                  - min: 0
                apex_config:
                  stroke:
                    width: 2
                  legend:
                    show: true
                series:
                  - entity: sensor.speedtest_ping
                    name: Ping
                    type: line
                    color: '#ef6c00'
                    float_precision: 1
                  - entity: sensor.speedtest_ping_30d_avg
                    name: Ping 30d avg
                    type: line
                    color: '#ffb300'
                    float_precision: 1
          2w:
            type: vertical-stack
            cards:
              - type: custom:apexcharts-card
                header:
                  title: Latency trend (2w)
                  show: true
                graph_span: 14d
                span:
                  end: day
                yaxis:
                  - min: 0
                apex_config:
                  stroke:
                    width: 2
                  legend:
                    show: true
                series:
                  - entity: sensor.internet_latency
                    name: Current
                    color: '#1e88e5'
                    float_precision: 1
                  - entity: sensor.internet_latency_24h_avg
                    name: 24h avg
                    color: '#fdd835'
                    type: line
                    float_precision: 1
                  - entity: sensor.internet_latency_7d_avg
                    name: 7d avg
                    color: '#43a047'
                    type: line
                    float_precision: 1
              - type: custom:apexcharts-card
                header:
                  title: Speedtest download vs upload (2w)
                  show: true
                graph_span: 14d
                span:
                  end: day
                yaxis:
                  - min: 0
                apex_config:
                  stroke:
                    width: 2
                  legend:
                    show: true
                series:
                  - entity: sensor.speedtest_download
                    name: Download
                    type: line
                    color: '#3949ab'
                    float_precision: 1
                  - entity: sensor.speedtest_upload
                    name: Upload
                    type: line
                    color: '#8d6e63'
                    float_precision: 1
                  - entity: sensor.speedtest_download_30d_avg
                    name: Download 30d avg
                    type: line
                    color: '#5c6bc0'
                    float_precision: 1
                  - entity: sensor.speedtest_upload_30d_avg
                    name: Upload 30d avg
                    type: line
                    color: '#a1887f'
                    float_precision: 1
              - type: custom:apexcharts-card
                header:
                  title: Deco throughput (2w)
                  show: true
                graph_span: 14d
                span:
                  end: day
                yaxis:
                  - min: 0
                apex_config:
                  stroke:
                    width: 2
                  legend:
                    show: true
                series:
                  - entity: sensor.deco_total_down_mbps
                    name: Down
                    type: line
                    color: '#26a69a'
                    float_precision: 2
                  - entity: sensor.deco_total_up_mbps
                    name: Up
                    type: line
                    color: '#7e57c2'
                    float_precision: 2
                  - entity: sensor.deco_total_down_mbps_7d_avg
                    name: Down 7d avg
                    type: line
                    color: '#4db6ac'
                    float_precision: 2
                  - entity: sensor.deco_total_up_mbps_7d_avg
                    name: Up 7d avg
                    type: line
                    color: '#9575cd'
                    float_precision: 2
              - type: custom:apexcharts-card
                header:
                  title: Speedtest ping (2w)
                  show: true
                graph_span: 14d
                span:
                  end: day
                yaxis:
                  - min: 0
                apex_config:
                  stroke:
                    width: 2
                  legend:
                    show: true
                series:
                  - entity: sensor.speedtest_ping
                    name: Ping
                    type: line
                    color: '#ef6c00'
                    float_precision: 1
                  - entity: sensor.speedtest_ping_30d_avg
                    name: Ping 30d avg
                    type: line
                    color: '#ffb300'
                    float_precision: 1
          1m:
            type: vertical-stack
            cards:
              - type: custom:apexcharts-card
                header:
                  title: Latency trend (1m)
                  show: true
                graph_span: 30d
                span:
                  end: day
                yaxis:
                  - min: 0
                apex_config:
                  stroke:
                    width: 2
                  legend:
                    show: true
                series:
                  - entity: sensor.internet_latency
                    name: Current
                    color: '#1e88e5'
                    float_precision: 1
                  - entity: sensor.internet_latency_24h_avg
                    name: 24h avg
                    color: '#fdd835'
                    type: line
                    float_precision: 1
                  - entity: sensor.internet_latency_7d_avg
                    name: 7d avg
                    color: '#43a047'
                    type: line
                    float_precision: 1
              - type: custom:apexcharts-card
                header:
                  title: Speedtest download vs upload (1m)
                  show: true
                graph_span: 30d
                span:
                  end: day
                yaxis:
                  - min: 0
                apex_config:
                  stroke:
                    width: 2
                  legend:
                    show: true
                series:
                  - entity: sensor.speedtest_download
                    name: Download
                    type: line
                    color: '#3949ab'
                    float_precision: 1
                  - entity: sensor.speedtest_upload
                    name: Upload
                    type: line
                    color: '#8d6e63'
                    float_precision: 1
                  - entity: sensor.speedtest_download_30d_avg
                    name: Download 30d avg
                    type: line
                    color: '#5c6bc0'
                    float_precision: 1
                  - entity: sensor.speedtest_upload_30d_avg
                    name: Upload 30d avg
                    type: line
                    color: '#a1887f'
                    float_precision: 1
              - type: custom:apexcharts-card
                header:
                  title: Deco throughput (1m)
                  show: true
                graph_span: 30d
                span:
                  end: day
                yaxis:
                  - min: 0
                apex_config:
                  stroke:
                    width: 2
                  legend:
                    show: true
                series:
                  - entity: sensor.deco_total_down_mbps
                    name: Down
                    type: line
                    color: '#26a69a'
                    float_precision: 2
                  - entity: sensor.deco_total_up_mbps
                    name: Up
                    type: line
                    color: '#7e57c2'
                    float_precision: 2
                  - entity: sensor.deco_total_down_mbps_7d_avg
                    name: Down 7d avg
                    type: line
                    color: '#4db6ac'
                    float_precision: 2
                  - entity: sensor.deco_total_up_mbps_7d_avg
                    name: Up 7d avg
                    type: line
                    color: '#9575cd'
                    float_precision: 2
              - type: custom:apexcharts-card
                header:
                  title: Speedtest ping (1m)
                  show: true
                graph_span: 30d
                span:
                  end: day
                yaxis:
                  - min: 0
                apex_config:
                  stroke:
                    width: 2
                  legend:
                    show: true
                series:
                  - entity: sensor.speedtest_ping
                    name: Ping
                    type: line
                    color: '#ef6c00'
                    float_precision: 1
                  - entity: sensor.speedtest_ping_30d_avg
                    name: Ping 30d avg
                    type: line
                    color: '#ffb300'
                    float_precision: 1
          3m:
            type: vertical-stack
            cards:
              - type: custom:apexcharts-card
                header:
                  title: Latency trend (3m)
                  show: true
                graph_span: 90d
                span:
                  end: day
                yaxis:
                  - min: 0
                apex_config:
                  stroke:
                    width: 2
                  legend:
                    show: true
                series:
                  - entity: sensor.internet_latency
                    name: Current
                    color: '#1e88e5'
                    float_precision: 1
                  - entity: sensor.internet_latency_24h_avg
                    name: 24h avg
                    color: '#fdd835'
                    type: line
                    float_precision: 1
                  - entity: sensor.internet_latency_7d_avg
                    name: 7d avg
                    color: '#43a047'
                    type: line
                    float_precision: 1
              - type: custom:apexcharts-card
                header:
                  title: Speedtest download vs upload (3m)
                  show: true
                graph_span: 90d
                span:
                  end: day
                yaxis:
                  - min: 0
                apex_config:
                  stroke:
                    width: 2
                  legend:
                    show: true
                series:
                  - entity: sensor.speedtest_download
                    name: Download
                    type: line
                    color: '#3949ab'
                    float_precision: 1
                  - entity: sensor.speedtest_upload
                    name: Upload
                    type: line
                    color: '#8d6e63'
                    float_precision: 1
                  - entity: sensor.speedtest_download_30d_avg
                    name: Download 30d avg
                    type: line
                    color: '#5c6bc0'
                    float_precision: 1
                  - entity: sensor.speedtest_upload_30d_avg
                    name: Upload 30d avg
                    type: line
                    color: '#a1887f'
                    float_precision: 1
              - type: custom:apexcharts-card
                header:
                  title: Deco throughput (3m)
                  show: true
                graph_span: 90d
                span:
                  end: day
                yaxis:
                  - min: 0
                apex_config:
                  stroke:
                    width: 2
                  legend:
                    show: true
                series:
                  - entity: sensor.deco_total_down_mbps
                    name: Down
                    type: line
                    color: '#26a69a'
                    float_precision: 2
                  - entity: sensor.deco_total_up_mbps
                    name: Up
                    type: line
                    color: '#7e57c2'
                    float_precision: 2
                  - entity: sensor.deco_total_down_mbps_7d_avg
                    name: Down 7d avg
                    type: line
                    color: '#4db6ac'
                    float_precision: 2
                  - entity: sensor.deco_total_up_mbps_7d_avg
                    name: Up 7d avg
                    type: line
                    color: '#9575cd'
                    float_precision: 2
              - type: custom:apexcharts-card
                header:
                  title: Speedtest ping (3m)
                  show: true
                graph_span: 90d
                span:
                  end: day
                yaxis:
                  - min: 0
                apex_config:
                  stroke:
                    width: 2
                  legend:
                    show: true
                series:
                  - entity: sensor.speedtest_ping
                    name: Ping
                    type: line
                    color: '#ef6c00'
                    float_precision: 1
                  - entity: sensor.speedtest_ping_30d_avg
                    name: Ping 30d avg
                    type: line
                    color: '#ffb300'
                    float_precision: 1
