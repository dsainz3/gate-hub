title: Support · Test Resources
views:
  - title: Overview
    path: support-test-overview
    icon: mdi:view-dashboard-outline
    type: sections
    theme: Support Test Gold
    card_mod:
      style: |
        :host {
          --app-header-background-color: var(--support-test-header-test-bench-bg, var(--app-header-background-color));
          --app-header-text-color: var(--support-test-header-test-bench-fg, var(--app-header-text-color));
          --app-header-button-text-color: var(--support-test-header-test-bench-fg, var(--app-header-button-text-color));
          --app-header-icon-color: var(--support-test-header-test-bench-fg, var(--app-header-icon-color));
        }
    max_columns: 4
    sections:
      - type: grid
        columns: 4
        cards:
          - type: heading
            heading: Mission Overview
            heading_style: title
            view_layout:
              column_span: 4
          - type: custom:mushroom-chips-card
            alignment: start
            chips:
              - type: template
                entity: sensor.kiosk_snapshot_lights_on
                icon: mdi:lightbulb-group-outline
                icon_color: >-
                  {% set count = states('sensor.kiosk_snapshot_lights_on') | int(0) %}
                  {{ 'amber' if count > 0 else 'blue-grey' }}
                content: >-
                  {% set count = states('sensor.kiosk_snapshot_lights_on') %}
                  {% if count in ['', 'unknown', 'unavailable', none] %}
                    Lights · —
                  {% else %}
                    Lights · {{ count }} on
                  {% endif %}
                tap_action:
                  action: navigate
                  navigation_path: /lovelace/support-test-lights
              - type: template
                entity: weather.forecast_home
                icon: mdi:weather-partly-cloudy
                icon_color: >-
                  {% set condition = states('weather.forecast_home') %}
                  {% set palette = {
                    'sunny': 'amber',
                    'clear-night': 'indigo',
                    'cloudy': 'blue-grey',
                    'partlycloudy': 'light-blue',
                    'mostlycloudy': 'light-blue',
                    'rainy': 'blue',
                    'pouring': 'blue'
                  } %}
                  {{ palette.get(condition, 'teal') }}
                content: >-
                  {% set temp = states('sensor.outdoor_temperature_wx') %}
                  {% if temp in ['', 'unknown', 'unavailable', none] %}
                    Weather · {{ states('weather.forecast_home') | title }}
                  {% else %}
                    Weather · {{ states('weather.forecast_home') | title }} · {{ temp }}°F
                  {% endif %}
                tap_action:
                  action: navigate
                  navigation_path: /lovelace/support-test-weather
              - type: template
                entity: sensor.outdoor_humidity_wx
                icon: mdi:water-percent
                icon_color: indigo
                content: >-
                  {% set humidity = states('sensor.outdoor_humidity_wx') %}
                  {% if humidity in ['', 'unknown', 'unavailable', none] %}
                    Humidity · —
                  {% else %}
                    Humidity · {{ humidity }}%
                  {% endif %}
                tap_action:
                  action: more-info
                  entity: sensor.outdoor_humidity_wx
              - type: template
                entity: sensor.outdoor_wind_speed_wx
                icon: mdi:weather-windy
                icon_color: teal
                content: >-
                  {% set speed = states('sensor.outdoor_wind_speed_wx') %}
                  {% set bearing = state_attr('weather.forecast_home', 'wind_bearing') %}
                  {% if speed in ['', 'unknown', 'unavailable', none] %}
                    Wind · —
                  {% else %}
                    {% if bearing in ['', 'unknown', 'unavailable', none] %}
                      Wind · {{ speed }} mph
                    {% else %}
                      {% set dirs = ['N', 'NE', 'E', 'SE', 'S', 'SW', 'W', 'NW'] %}
                      {% set index = ((bearing | float(0) + 22.5) / 45) | int %}
                      {% set cardinal = dirs[index % 8] %}
                      Wind · {{ speed }} mph {{ cardinal }}
                    {% endif %}
                  {% endif %}
                tap_action:
                  action: more-info
                  entity: weather.forecast_home
              - type: template
                entity: switch.sprinkler_scheduled_program
                icon: mdi:sprinkler-variant
                icon_color: >-
                  {{ 'green' if is_state('switch.sprinkler_scheduled_program', 'on') else 'blue-grey' }}
                content: >-
                  {% set zones = [
                    'switch.sprinkler_south_side_zone',
                    'switch.sprinkler_back_south_zone',
                    'switch.sprinkler_back_north_zone',
                    'switch.sprinkler_front_zone',
                    'switch.sprinkler_zone_5_zone'
                  ] %}
                  {% set running = [] %}
                  {% for zone in zones %}
                    {% if is_state(zone, 'on') %}
                      {% set running = running + [state_attr(zone, 'friendly_name') | default(zone.split('.')[-1] | replace('_', ' ') | title)] %}
                    {% endif %}
                  {% endfor %}
                  {% if running %}
                    Sprinklers · Running
                  {% elif is_state('switch.sprinkler_scheduled_program', 'on') %}
                    Sprinklers · Scheduled
                  {% else %}
                    Sprinklers · Idle
                  {% endif %}
                tap_action:
                  action: navigate
                  navigation_path: /lovelace/support-test-weather
              - type: template
                entity: sensor.support_test_resources_briefing
                icon: mdi:palette-swatch
                icon_color: >-
                  {% set active = state_attr('sensor.support_test_resources_briefing', 'active_scenes') | count %}
                  {{ 'purple' if active > 0 else 'blue-grey' }}
                content: >-
                  {% set active = state_attr('sensor.support_test_resources_briefing', 'active_scenes') %}
                  {% if active is iterable and active | count > 0 %}
                    Scenes · {{ active | count }} active
                  {% else %}
                    Scenes · None active
                  {% endif %}
                tap_action:
                  action: navigate
                  navigation_path: /lovelace/support-test-scenes
            view_layout:
              column_span: 4
          - type: grid
            columns: 4
            cards:
              - type: markdown
                title: Lights briefing
                content: >-
                  {% set summary = state_attr('sensor.support_test_resources_briefing', 'lights_briefing') %}
                  {{ summary if summary not in [None, '', 'unknown', 'unavailable'] else 'Light summary is currently unavailable.' }}
                card_mod:
                  style: |
                    ha-card {
                      background: linear-gradient(135deg, rgba(245,158,11,0.15), rgba(249,115,22,0.25));
                      border-radius: 16px;
                      box-shadow: none;
                      padding: 1.2rem;
                    }
              - type: markdown
                title: Weather & water
                content: >-
                  {% set summary = state_attr('sensor.support_test_resources_briefing', 'weather_briefing') %}
                  {{ summary if summary not in [None, '', 'unknown', 'unavailable'] else 'Weather summary is currently unavailable.' }}
                card_mod:
                  style: |
                    ha-card {
                      background: linear-gradient(135deg, rgba(59,130,246,0.15), rgba(37,99,235,0.25));
                      border-radius: 16px;
                      box-shadow: none;
                      padding: 1.2rem;
                    }
              - type: markdown
                title: Network watch
                content: >-
                  {% set summary = state_attr('sensor.support_test_resources_briefing', 'network_briefing') %}
                  {{ summary if summary not in [None, '', 'unknown', 'unavailable'] else 'Network summary is currently unavailable.' }}
                card_mod:
                  style: |
                    ha-card {
                      background: linear-gradient(135deg, rgba(16,185,129,0.15), rgba(5,150,105,0.25));
                      border-radius: 16px;
                      box-shadow: none;
                      padding: 1.2rem;
                    }
              - type: markdown
                title: Sports desk
                content: >-
                  {% set summary = state_attr('sensor.support_test_resources_briefing', 'sports_briefing') %}
                  {{ summary if summary not in [None, '', 'unknown', 'unavailable'] else 'Sports summary is currently unavailable.' }}
                card_mod:
                  style: |
                    ha-card {
                      background: linear-gradient(135deg, rgba(168,85,247,0.15), rgba(124,58,237,0.25));
                      border-radius: 16px;
                      box-shadow: none;
                      padding: 1.2rem;
                    }
            view_layout:
              column_span: 4
          - type: grid
            columns: 4
            cards:
              - type: custom:mushroom-template-card
                entity: sensor.kiosk_snapshot_aux_readout
                icon: mdi:lightbulb-on-outline
                icon_color: amber
                primary: Interior snapshot
                secondary: '{{ states(''sensor.kiosk_snapshot_aux_readout'') }}'
                fill_container: true
                layout: vertical
                multiline_secondary: true
              - type: custom:mushroom-template-card
                entity: sensor.network_status_summary
                icon: mdi:lan-check
                icon_color: >-
                  {{ 'green' if is_state('sensor.network_status_summary', 'Online') else 'red' }}
                primary: Network status
                secondary: '{{ states(''sensor.network_status_summary'') }}'
                fill_container: true
                layout: vertical
              - type: custom:mushroom-template-card
                entity: sensor.hygrometer_humidor_humidity
                icon: mdi:cigar
                icon_color: >-
                  {% if is_state('binary_sensor.kiosk_humidor_out_of_band', 'off') %}
                    teal
                  {% else %}
                    red
                  {% endif %}
                primary: Humidor humidity
                secondary: >-
                  {{ states('sensor.hygrometer_humidor_humidity') | default('—', true) }}%
                layout: vertical
                fill_container: true
              - type: custom:mushroom-template-card
                entity: sensor.support_test_resources_briefing
                icon: mdi:battery-alert
                icon_color: >-
                  {% set low = state_attr('sensor.support_test_resources_briefing', 'low_batteries') %}
                  {{ 'amber' if low is iterable and low | count > 0 else 'green' }}
                primary: Battery alerts
                secondary: >-
                  {% set low = state_attr('sensor.support_test_resources_briefing', 'low_batteries') %}
                  {% if low is iterable and low | count > 0 %}
                    {{ low | join(', ') }}
                  {% else %}
                    No low batteries detected
                  {% endif %}
                layout: vertical
                fill_container: true
        view_layout:
          column_span: 4
    badges:
      - entity: sensor.kiosk_snapshot_lights_on
        name: Lights On
      - entity: sensor.outdoor_temperature_wx
        name: Outdoor Temp
      - entity: sensor.outdoor_humidity_wx
        name: Outdoor Humidity
      - entity: sensor.outdoor_wind_speed_wx
        name: Wind Speed
      - entity: switch.sprinkler_scheduled_program
        name: Sprinkler Program
      - entity: sensor.network_status_summary
        name: Network
  - title: Lights
    path: support-test-lights
    icon: mdi:lightbulb-on
    type: sections
    theme: Support Test Gold
    card_mod:
      style: |
        :host {
          --app-header-background-color: var(--support-test-header-test-bench-bg, var(--app-header-background-color));
          --app-header-text-color: var(--support-test-header-test-bench-fg, var(--app-header-text-color));
          --app-header-button-text-color: var(--support-test-header-test-bench-fg, var(--app-header-button-text-color));
          --app-header-icon-color: var(--support-test-header-test-bench-fg, var(--app-header-icon-color));
        }
    max_columns: 4
    sections:
      - type: grid
        columns: 4
        cards:
          - type: heading
            heading: Lighting overview
            heading_style: title
          - type: markdown
            content: >-
              {% set summary = state_attr('sensor.support_test_resources_briefing', 'lights_briefing') %}
              {{ summary if summary not in [None, '', 'unknown', 'unavailable'] else 'Light summary is currently unavailable.' }}
            card_mod:
              style: |
                ha-card {
                  background: linear-gradient(135deg, rgba(245,158,11,0.12), rgba(249,115,22,0.24));
                  border-radius: 16px;
                  box-shadow: none;
                  padding: 1.1rem;
                }
            view_layout:
              column_span: 4
      - type: grid
        columns: 4
        cards:
          - type: custom:mushroom-light-card
            entity: light.all_lights
            name: All lights
            icon: mdi:lightbulb-group
            fill_container: true
          - type: custom:mushroom-light-card
            entity: light.mainfloor_lights
            name: Mainfloor
            icon: mdi:sofa
            fill_container: true
          - type: custom:mushroom-light-card
            entity: light.theater_lights
            name: Theater
            icon: mdi:movie-open
            fill_container: true
          - type: custom:mushroom-light-card
            entity: light.office_lights
            name: Office
            icon: mdi:desk-lamp
            fill_container: true
          - type: custom:mushroom-light-card
            entity: light.all_exterior_lights
            name: Exterior lights
            icon: mdi:coach-lamp
            fill_container: true
          - type: custom:mushroom-light-card
            entity: light.permanent_outdoor_lights_3
            name: Permanent exterior
            icon: mdi:string-lights
            fill_container: true
          - type: custom:mushroom-light-card
            entity: light.garage_lights
            name: Garage
            icon: mdi:garage
            fill_container: true
          - type: custom:mushroom-light-card
            entity: light.sunroom_light
            name: Sunroom
            icon: mdi:white-balance-iridescent
            fill_container: true
      - type: grid
        columns: 4
        cards:
          - type: custom:mushroom-template-card
            entity: sensor.kiosk_snapshot_aux_readout
            icon: mdi:chart-timeline-variant
            icon_color: teal
            primary: Lighting snapshot
            secondary: >-
              {{ states('sensor.kiosk_snapshot_aux_readout') }} · Lights On {{ states('sensor.kiosk_snapshot_lights_on') }} · Plugs {{ states('sensor.kiosk_snapshot_plugs_on') }}
            layout: vertical
            fill_container: true
            multiline_secondary: true
          - type: custom:mushroom-template-card
            entity: binary_sensor.kiosk_automations_have_issues
            icon: mdi:toggle-switch
            icon_color: >-
              {{ 'green' if is_state('binary_sensor.kiosk_automations_have_issues', 'off') else 'red' }}
            primary: Automation health
            secondary: >-
              Issues {{ states('sensor.kiosk_automations_problem_count') }}
            layout: vertical
            fill_container: true
          - type: custom:mushroom-template-card
            entity: input_boolean.holiday_mode_manual
            icon: mdi:calendar-heart
            icon_color: pink
            primary: Holiday mode
            secondary: >-
              {{ 'Enabled' if is_state('input_boolean.holiday_mode_manual', 'on') else 'Disabled' }} · Next holiday {{ states('sensor.next_us_holiday') | default('—', true) }}
            layout: vertical
            fill_container: true
  - title: Weather & Sprinklers
    path: support-test-weather
    icon: mdi:weather-rainy
    type: sections
    theme: Support Test Gold
    card_mod:
      style: |
        :host {
          --app-header-background-color: var(--support-test-header-test-bench-bg, var(--app-header-background-color));
          --app-header-text-color: var(--support-test-header-test-bench-fg, var(--app-header-text-color));
          --app-header-button-text-color: var(--support-test-header-test-bench-fg, var(--app-header-button-text-color));
          --app-header-icon-color: var(--support-test-header-test-bench-fg, var(--app-header-icon-color));
        }
    max_columns: 4
    sections:
      - type: grid
        columns: 4
        cards:
          - type: heading
            heading: Weather & irrigation
            heading_style: title
          - type: markdown
            content: >-
              {% set summary = state_attr('sensor.support_test_resources_briefing', 'weather_briefing') %}
              {{ summary if summary not in [None, '', 'unknown', 'unavailable'] else 'Weather summary is currently unavailable.' }}
            card_mod:
              style: |
                ha-card {
                  background: linear-gradient(135deg, rgba(59,130,246,0.12), rgba(37,99,235,0.24));
                  border-radius: 16px;
                  box-shadow: none;
                  padding: 1.1rem;
                }
            view_layout:
              column_span: 4
      - type: grid
        columns: 4
        cards:
          - type: custom:apexcharts-card
            header:
              show: true
              title: Outdoor comfort trend
              show_states: true
            graph_span: 3d
            now:
              show: true
            apex_config:
              chart:
                height: 260
              legend:
                position: top
            yaxis:
              - id: temperature
                min: 20
                apex_config:
                  labels:
                    formatter: |
                      function(value) {
                        return value.toFixed(0) + '°F';
                      }
              - id: humidity
                opposite: true
                min: 0
                max: 100
                apex_config:
                  labels:
                    formatter: |
                      function(value) {
                        return value.toFixed(0) + '%';
                      }
            series:
              - entity: sensor.outdoor_temperature_wx
                name: Outdoor temperature
                type: line
                stroke_width: 3
                extend_to: now
                yaxis_id: temperature
                color: '#f97316'
                group_by:
                  duration: 30min
                  func: avg
              - entity: sensor.outdoor_humidity_wx
                name: Outdoor humidity
                type: area
                extend_to: now
                yaxis_id: humidity
                color: '#6366f1'
                opacity: 0.25
                stroke_width: 2
                group_by:
                  duration: 30min
                  func: avg
          - type: custom:mushroom-entity-card
            entity: weather.forecast_home
            name: Forecast snapshot
            icon: mdi:weather-cloudy-clock
            layout: vertical
            fill_container: true
            primary_info: state
            secondary_info: name
          - type: custom:mushroom-template-card
            entity: switch.sprinkler_scheduled_program
            icon: mdi:sprinkler-variant
            icon_color: >-
              {{ 'green' if is_state('switch.sprinkler_scheduled_program', 'on') else 'blue-grey' }}
            primary: Schedule status
            secondary: >-
              {{ 'Scheduled program is active' if is_state('switch.sprinkler_scheduled_program', 'on') else 'Program idle' }}
            layout: vertical
            fill_container: true
            multiline_secondary: true
          - type: custom:mushroom-template-card
            entity: sensor.support_test_resources_briefing
            icon: mdi:timer-outline
            icon_color: teal
            primary: Today's runtime
            secondary: >-
              {% set runtime = state_attr('sensor.support_test_resources_briefing', 'sprinkler_runtime_today') %}
              {% if runtime not in [None, ''] %}
                {{ runtime }} minutes total
              {% else %}
                Runtime not available
              {% endif %}
            layout: vertical
            fill_container: true
      - type: grid
        columns: 4
        cards:
          - type: custom:mushroom-entity-card
            entity: switch.sprinkler_south_side_zone
            name: South side zone
            icon: mdi:sprinkler
            fill_container: true
          - type: custom:mushroom-entity-card
            entity: switch.sprinkler_back_south_zone
            name: Back south zone
            icon: mdi:sprinkler
            fill_container: true
          - type: custom:mushroom-entity-card
            entity: switch.sprinkler_back_north_zone
            name: Back north zone
            icon: mdi:sprinkler
            fill_container: true
          - type: custom:mushroom-entity-card
            entity: switch.sprinkler_front_zone
            name: Front zone
            icon: mdi:sprinkler
            fill_container: true
          - type: custom:mushroom-entity-card
            entity: switch.sprinkler_zone_5_zone
            name: Zone 5
            icon: mdi:sprinkler
            fill_container: true
          - type: custom:mushroom-template-card
            entity: sensor.kiosk_sprinklers_south_side_runtime_today
            icon: mdi:chart-bar
            icon_color: teal
            primary: South side runtime today
            secondary: '{{ states(''sensor.kiosk_sprinklers_south_side_runtime_today'') }} min'
            layout: vertical
            fill_container: true
          - type: custom:mushroom-template-card
            entity: sensor.kiosk_sprinklers_back_south_runtime_today
            icon: mdi:chart-bar
            icon_color: teal
            primary: Back south runtime today
            secondary: '{{ states(''sensor.kiosk_sprinklers_back_south_runtime_today'') }} min'
            layout: vertical
            fill_container: true
          - type: custom:mushroom-template-card
            entity: sensor.kiosk_sprinklers_back_north_runtime_today
            icon: mdi:chart-bar
            icon_color: teal
            primary: Back north runtime today
            secondary: '{{ states(''sensor.kiosk_sprinklers_back_north_runtime_today'') }} min'
            layout: vertical
            fill_container: true
          - type: custom:mushroom-template-card
            entity: sensor.kiosk_sprinklers_front_runtime_today
            icon: mdi:chart-bar
            icon_color: teal
            primary: Front runtime today
            secondary: '{{ states(''sensor.kiosk_sprinklers_front_runtime_today'') }} min'
            layout: vertical
            fill_container: true
          - type: custom:mushroom-template-card
            entity: sensor.kiosk_sprinklers_zone5_runtime_today
            icon: mdi:chart-bar
            icon_color: teal
            primary: Zone 5 runtime today
            secondary: '{{ states(''sensor.kiosk_sprinklers_zone5_runtime_today'') }} min'
            layout: vertical
            fill_container: true
  - title: Networking
    path: support-test-network
    icon: mdi:access-point-network
    type: sections
    theme: Support Test Gold
    card_mod:
      style: |
        :host {
          --app-header-background-color: var(--support-test-header-test-bench-bg, var(--app-header-background-color));
          --app-header-text-color: var(--support-test-header-test-bench-fg, var(--app-header-text-color));
          --app-header-button-text-color: var(--support-test-header-test-bench-fg, var(--app-header-button-text-color));
          --app-header-icon-color: var(--support-test-header-test-bench-fg, var(--app-header-icon-color));
        }
    max_columns: 4
    sections:
      - type: grid
        columns: 4
        cards:
          - type: heading
            heading: Network pulse
            heading_style: title
          - type: markdown
            content: >-
              {% set summary = state_attr('sensor.support_test_resources_briefing', 'network_briefing') %}
              {{ summary if summary not in [None, '', 'unknown', 'unavailable'] else 'Network summary is currently unavailable.' }}
            card_mod:
              style: |
                ha-card {
                  background: linear-gradient(135deg, rgba(16,185,129,0.12), rgba(5,150,105,0.24));
                  border-radius: 16px;
                  box-shadow: none;
                  padding: 1.1rem;
                }
            view_layout:
              column_span: 4
      - type: grid
        columns: 4
        cards:
          - type: custom:mushroom-template-card
            entity: sensor.deco_total_down_mbps
            icon: mdi:access-point-network
            icon_color: blue
            primary: Deco mesh throughput
            secondary: |
              ↓ {{ states('sensor.deco_total_down_mbps') }} Mbps
              ↑ {{ states('sensor.deco_total_up_mbps') }} Mbps
              Nodes {{ states('sensor.deco_node_count') }}
            layout: vertical
            fill_container: true
            multiline_secondary: true
          - type: custom:mushroom-template-card
            entity: sensor.network_performance_summary
            icon: mdi:chart-bell-curve
            icon_color: >-
              {% if states('sensor.network_performance_summary') == 'excellent' %}
                green
              {% elif states('sensor.network_performance_summary') == 'degraded' %}
                amber
              {% else %}
                teal
              {% endif %}
            primary: Client mix
            secondary: >-
              Wi-Fi {{ states('sensor.deco_client_count') }} · Guest {{ states('sensor.tp_link_router_total_guest_wifi_clients') | default('—', true) }}

              Wired {{ states('sensor.tp_link_router_total_wired_clients') | default('—', true) }}
            layout: vertical
            fill_container: true
            multiline_secondary: true
          - type: custom:mushroom-template-card
            entity: sensor.network_status_summary
            icon: mdi:lan-check
            icon_color: >-
              {{ 'green' if is_state('sensor.network_status_summary', 'Online') else 'red' }}
            primary: Status check
            secondary: '{{ states(''sensor.network_status_summary'') }}'
            layout: vertical
            fill_container: true
          - type: custom:mushroom-template-card
            entity: sensor.support_test_resources_briefing
            icon: mdi:speedometer
            icon_color: indigo
            primary: Speedtest snapshot
            secondary: >-
              {% set download = states('sensor.speedtest_download') %}
              {% set upload = states('sensor.speedtest_upload') %}
              {% set ping = states('sensor.speedtest_ping') %}
              {% set invalid = ['', 'unknown', 'unavailable', none] %}
              {% if download in invalid or upload in invalid or ping in invalid %}
                Latest results unavailable
              {% else %}
                ↓ {{ download }} Mbps · ↑ {{ upload }} Mbps · Ping {{ ping }} ms
              {% endif %}
            layout: vertical
            fill_container: true
            multiline_secondary: true
      - type: grid
        columns: 4
        cards:
          - type: custom:apexcharts-card
            header:
              show: true
              title: Speedtest history
              show_states: true
            graph_span: 7d
            now:
              show: true
            apex_config:
              chart:
                height: 260
              legend:
                position: top
            yaxis:
              - id: bandwidth
                min: 0
            series:
              - entity: sensor.speedtest_download
                name: Download
                type: column
                color: '#10b981'
                stroke_width: 0
                yaxis_id: bandwidth
                group_by:
                  duration: 6h
                  func: max
              - entity: sensor.speedtest_upload
                name: Upload
                type: column
                color: '#3b82f6'
                stroke_width: 0
                yaxis_id: bandwidth
                group_by:
                  duration: 6h
                  func: max
          - type: custom:apexcharts-card
            header:
              show: true
              title: Latency watch
              show_states: true
            graph_span: 3d
            now:
              show: true
            apex_config:
              chart:
                height: 260
            series:
              - entity: sensor.internet_latency_2
                name: Live latency
                type: line
                color: '#facc15'
                stroke_width: 3
                extend_to: now
                group_by:
                  duration: 15min
                  func: avg
              - entity: sensor.speedtest_ping
                name: Speedtest ping
                type: line
                color: '#fb7185'
                stroke_width: 2
                extend_to: now
                group_by:
                  duration: 6h
                  func: avg
  - title: Sports & Events
    path: support-test-sports
    icon: mdi:stadium-variant
    type: sections
    theme: Support Test Gold
    card_mod:
      style: |
        :host {
          --app-header-background-color: var(--support-test-header-test-bench-bg, var(--app-header-background-color));
          --app-header-text-color: var(--support-test-header-test-bench-fg, var(--app-header-text-color));
          --app-header-button-text-color: var(--support-test-header-test-bench-fg, var(--app-header-button-text-color));
          --app-header-icon-color: var(--support-test-header-test-bench-fg, var(--app-header-icon-color));
        }
    max_columns: 4
    sections:
      - type: grid
        columns: 4
        cards:
          - type: heading
            heading: Game day hub
            heading_style: title
          - type: markdown
            content: >-
              {% set summary = state_attr('sensor.support_test_resources_briefing', 'sports_briefing') %}
              {{ summary if summary not in [None, '', 'unknown', 'unavailable'] else 'Sports summary is currently unavailable.' }}
            card_mod:
              style: |
                ha-card {
                  background: linear-gradient(135deg, rgba(168,85,247,0.12), rgba(124,58,237,0.24));
                  border-radius: 16px;
                  box-shadow: none;
                  padding: 1.1rem;
                }
            view_layout:
              column_span: 4
      - type: grid
        columns: 4
        cards:
          - type: custom:mushroom-chips-card
            alignment: start
            chips:
              - type: template
                entity: sensor.huskers_game_phase_label
                icon: mdi:football
                icon_color: >-
                  {% if is_state('sensor.huskers_game_phase_label', 'Live') %}
                    red
                  {% elif is_state('sensor.huskers_game_phase_label', 'Final') %}
                    blue-grey
                  {% else %}
                    grey
                  {% endif %}
                content: Phase · {{ states('sensor.huskers_game_phase_label') }}
              - type: template
                entity: sensor.huskers_series_summary
                icon: mdi:account-group
                icon_color: red
                content: Series · {{ states('sensor.huskers_series_summary') }}
              - type: template
                entity: binary_sensor.f1_is_race_week
                icon: mdi:flag-checkered
                icon_color: >-
                  {{ 'purple' if is_state('binary_sensor.f1_is_race_week', 'on') else 'grey' }}
                content: Race Week · {{ states('binary_sensor.f1_is_race_week') | title }}
              - type: template
                entity: sensor.f1_next_race_round
                icon: mdi:counter
                icon_color: purple
                content: Round {{ states('sensor.f1_next_race_round') }}
            view_layout:
              column_span: 4
      - type: grid
        columns: 4
        cards:
          - type: custom:mushroom-template-card
            entity: sensor.huskers_game_phase_label
            icon: mdi:scoreboard-outline
            icon_color: red
            primary: >-
              {{ states('sensor.huskers_team_name') }} {{ states('sensor.huskers_team_score') }} – {{ states('sensor.huskers_opponent_score_2') }} {{ states('sensor.huskers_opponent_name_2') }}
            secondary: >-
              {{ states('sensor.huskers_game_phase_label') }} · {{ states('sensor.huskers_game_detail') }}
            layout: vertical
            fill_container: true
            multiline_secondary: true
            tap_action:
              action: more-info
              entity: sensor.huskers_series_summary
            view_layout:
              column_span: 2
          - type: custom:mushroom-template-card
            entity: sensor.huskers_series_summary
            icon: mdi:clipboard-text-clock
            icon_color: red
            primary: Series storyline
            secondary: '{{ states(''sensor.huskers_series_summary'') }}'
            layout: vertical
            fill_container: true
            multiline_secondary: true
            view_layout:
              column_span: 2
      - type: grid
        columns: 4
        cards:
          - type: custom:mushroom-template-card
            entity: sensor.f1_next_race_name
            icon: mdi:calendar-clock
            icon_color: purple
            primary: Next F1 · {{ states('sensor.f1_next_race_name') }}
            secondary: >
              {{ states('sensor.f1_next_race_location') }}

              {%- set lights_out = states('sensor.f1_lights_out_local') -%}

              Lights out {{ as_timestamp(lights_out) | timestamp_custom('%b %-d %-I:%M %p', True) if lights_out not in ['unknown', 'unavailable', none, ''] else 'TBA' }}
            layout: vertical
            fill_container: true
            multiline_secondary: true
            view_layout:
              column_span: 2
          - type: custom:mushroom-template-card
            entity: sensor.f1_next_race_sprint
            icon: mdi:timer-outline
            icon_color: >-
              {{ 'amber' if is_state('sensor.f1_next_race_sprint', 'Sprint') else 'blue-grey' }}
            primary: Weekend highlights
            secondary: >-
              Sprint {{ states('sensor.f1_next_race_sprint') | default('—', true) }} · Session {{ states('sensor.f1_next_session_name') | default('TBA', true) }}
            layout: vertical
            fill_container: true
            multiline_secondary: true
            view_layout:
              column_span: 2
  - title: Scenes
    path: support-test-scenes
    icon: mdi:palette-swatch
    type: sections
    theme: Support Test Gold
    card_mod:
      style: |
        :host {
          --app-header-background-color: var(--support-test-header-test-bench-bg, var(--app-header-background-color));
          --app-header-text-color: var(--support-test-header-test-bench-fg, var(--app-header-text-color));
          --app-header-button-text-color: var(--support-test-header-test-bench-fg, var(--app-header-button-text-color));
          --app-header-icon-color: var(--support-test-header-test-bench-fg, var(--app-header-icon-color));
        }
    max_columns: 4
    sections:
      - type: grid
        columns: 4
        cards:
          - type: heading
            heading: Scene console
            heading_style: title
          - type: markdown
            content: >-
              {% set summary = state_attr('sensor.support_test_resources_briefing', 'scene_briefing') %}
              {{ summary if summary not in [None, '', 'unknown', 'unavailable'] else 'Scene summary is currently unavailable.' }}
            card_mod:
              style: |
                ha-card {
                  background: linear-gradient(135deg, rgba(147,197,253,0.12), rgba(59,130,246,0.22));
                  border-radius: 16px;
                  box-shadow: none;
                  padding: 1.1rem;
                }
            view_layout:
              column_span: 4
      - type: grid
        columns: 3
        cards:
          - type: custom:mushroom-entity-card
            entity: scene.lighting_evening_sunset_interior
            name: Evening · Interior
            icon: mdi:palette-swatch
            layout: horizontal
            fill_container: true
            tap_action:
              action: call-service
              service: scene.turn_on
              data:
                entity_id: scene.lighting_evening_sunset_interior
          - type: custom:mushroom-entity-card
            entity: scene.lighting_evening_sunset_exterior
            name: Evening · Exterior
            icon: mdi:palette-swatch
            layout: horizontal
            fill_container: true
            tap_action:
              action: call-service
              service: scene.turn_on
              data:
                entity_id: scene.lighting_evening_sunset_exterior
          - type: custom:mushroom-entity-card
            entity: scene.lighting_morning_interior_off
            name: Morning · Interior off
            icon: mdi:palette-swatch
            layout: horizontal
            fill_container: true
            tap_action:
              action: call-service
              service: scene.turn_on
              data:
                entity_id: scene.lighting_morning_interior_off
          - type: custom:mushroom-entity-card
            entity: scene.lighting_morning_exterior_off
            name: Morning · Exterior off
            icon: mdi:palette-swatch
            layout: horizontal
            fill_container: true
            tap_action:
              action: call-service
              service: scene.turn_on
              data:
                entity_id: scene.lighting_morning_exterior_off
          - type: custom:mushroom-entity-card
            entity: scene.lighting_daytime_cloudy_interior
            name: Daytime cloudy · Interior
            icon: mdi:palette-swatch
            layout: horizontal
            fill_container: true
            tap_action:
              action: call-service
              service: scene.turn_on
              data:
                entity_id: scene.lighting_daytime_cloudy_interior
          - type: custom:mushroom-entity-card
            entity: scene.lighting_daytime_cloudy_exterior
            name: Daytime cloudy · Exterior
            icon: mdi:palette-swatch
            layout: horizontal
            fill_container: true
            tap_action:
              action: call-service
              service: scene.turn_on
              data:
                entity_id: scene.lighting_daytime_cloudy_exterior
          - type: custom:mushroom-entity-card
            entity: scene.lighting_exterior_led_effect_halloween
            name: LED · Halloween
            icon: mdi:palette-swatch
            layout: horizontal
            fill_container: true
            tap_action:
              action: call-service
              service: scene.turn_on
              data:
                entity_id: scene.lighting_exterior_led_effect_halloween
          - type: custom:mushroom-entity-card
            entity: scene.lighting_exterior_led_effect_thanksgiving
            name: LED · Thanksgiving
            icon: mdi:palette-swatch
            layout: horizontal
            fill_container: true
            tap_action:
              action: call-service
              service: scene.turn_on
              data:
                entity_id: scene.lighting_exterior_led_effect_thanksgiving
          - type: custom:mushroom-entity-card
            entity: scene.lighting_exterior_led_effect_christmas
            name: LED · Christmas
            icon: mdi:palette-swatch
            layout: horizontal
            fill_container: true
            tap_action:
              action: call-service
              service: scene.turn_on
              data:
                entity_id: scene.lighting_exterior_led_effect_christmas
          - type: custom:mushroom-entity-card
            entity: scene.huskers_sunroom_chase
            name: Huskers chase
            icon: mdi:football-helmet
            layout: horizontal
            fill_container: true
            tap_action:
              action: call-service
              service: scene.turn_on
              data:
                entity_id: scene.huskers_sunroom_chase
          - type: custom:mushroom-entity-card
            entity: scene.f1_lights_out_green
            name: F1 lights out
            icon: mdi:flag-checkered
            layout: horizontal
            fill_container: true
            tap_action:
              action: call-service
              service: scene.turn_on
              data:
                entity_id: scene.f1_lights_out_green
